<div class="container">
  <div class="section-header">
    <h2>Reporte de Inventario</h2>
  </div>

  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <!-- Filtros -->
  <div class="filters-section">
    <div class="filter-actions">
      <button (click)="cargarReporte()" class="btn btn-primary">
        <span class="material-icons">search</span>
        Cargar
      </button>
      <button (click)="limpiarFiltros()" class="btn btn-secondary">
        <span class="material-icons">clear</span>
        Limpiar
      </button>
    </div>
  </div>

  <!-- Resumen -->
  <div class="summary" *ngIf="!loading && movimientos.length > 0">
    <div class="summary-item">
      <span class="label">Total Movimientos</span>
      <span class="value">{{ totalMovimientos }}</span>
    </div>
    <div class="summary-item">
      <span class="label">Entradas</span>
      <span class="value">{{ totalEntradas }}</span>
    </div>
    <div class="summary-item">
      <span class="label">Salidas</span>
      <span class="value">{{ totalSalidas }}</span>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="spinner">
    <div class="spinner-border"></div>
    <p>Cargando reporte...</p>
  </div>

  <!-- Tabla -->
  <div *ngIf="!loading" class="table-container">
    <table class="table" *ngIf="movimientos.length > 0">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Producto</th>
          <th>Tipo</th>
          <th>Cantidad</th>
          <th>Stock Anterior</th>
          <th>Stock Nuevo</th>
          <th>Costo Unitario</th>
          <th>Costo Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let mov of movimientos">
          <td>{{ mov.movement_date | date: 'dd/MM/yyyy HH:mm' }}</td>
          <td>{{ mov.product?.name }}</td>
          <td>
            <span [class]="'badge badge-' + (mov.movement_type === 'entrada' ? 'success' : 'danger')">
              {{ mov.movement_type | uppercase }}
            </span>
          </td>
          <td>{{ mov.quantity }}</td>
          <td>{{ mov.previous_stock }}</td>
          <td>{{ mov.new_stock }}</td>
          <td>{{ mov.unit_cost | currency }}</td>
          <td>{{ mov.total_cost | currency }}</td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="movimientos.length === 0" class="empty-state">
      <span class="material-icons">inventory_2</span>
      <p>No hay movimientos de inventario</p>
    </div>
  </div>

  <!-- Acciones -->
  <div class="actions">
    <button (click)="descargarPDF()" class="btn-icon" title="Descargar PDF">
      <span class="material-icons">file_download</span>
    </button>
    <button (click)="volver()" class="btn btn-secondary">
      <span class="material-icons">arrow_back</span>
      Volver a Reportes
    </button>
  </div>
</div>
